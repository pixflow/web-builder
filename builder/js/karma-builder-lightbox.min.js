var karmaImageLightbox=function(selector){this.selector=selector;this.href=document.querySelector(selector).getAttribute("href");this.init()};karmaImageLightbox.prototype.init=function(){var that=this;var handler=that.openLightbox.bind(that);jQuery(document.querySelector(this.selector)).on("click.karma-lightbox",handler)};karmaImageLightbox.prototype.openLightbox=function(e){e.preventDefault();if(document.querySelectorAll("#karma-lightbox-opened").length){return}var html=document.querySelector("html");if(html.classList){html.classList.add("karma-image-lightbox-active")}else{html.className+=" karma-image-lightbox-active"}var image=document.querySelector(this.selector).href;this.createLightboxHtml(image)};karmaImageLightbox.prototype.closeLightbox=function(){var html=document.querySelector("html");var activeClass="karma-image-lightbox-active";if(html.classList){html.classList.remove(activeClass)}else{html.className=html.className.replace(new RegExp("(^|\\b)"+activeClass.split(" ").join("|")+"(\\b|$)","gi")," ")}document.getElementById("karma-lightbox-opened").remove()};karmaImageLightbox.prototype.createLightboxHtml=function(url){var that=this;var lightbox=document.createElement("div");lightbox.setAttribute("id","karma-lightbox-opened");var loading=document.createElement("span");loading.setAttribute("class","karma-lightbox-loading");loading.innerHTML="Loading ...";lightbox.appendChild(loading);var close=document.createElement("button");close.setAttribute("class","karma-lightbox-close");close.innerHTML="Ã—";lightbox.appendChild(close);var image=document.createElement("img");image.setAttribute("src",url);lightbox.appendChild(image);document.querySelector("body").appendChild(lightbox);lightbox.addEventListener("click",function(e){e.preventDefault();e.stopPropagation();if("IMG"===e.target.tagName){return}that.closeLightbox()},true)};