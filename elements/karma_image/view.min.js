(function($,karmaBuilder){karmaBuilder.image=karmaBuilder.shortcodes.extend({events:{"click .karma-image-link":"preventFromOpen","click .karma-image":"showGizmo"},initialize:function(){karmaBuilder.image.__super__.initialize.apply(this,arguments)},preventFromOpen:function(e){e.preventDefault();window.open(this.getAttributes(["linkurl"]).linkurl,"_blank")},showGizmo:function(){this.el.classList.add("karma-active-element")},imgurl:function(){var imageAddress=this.getAttributes(["imgurl"]);this.el.querySelector("img").setAttribute("src",imageAddress.imgurl)},scale:function(){var imageScale=this.getAttributes(["scale"]),containerClass="fill"==imageScale.scale?"karma-image-fill":"karma-image-real";this.el.querySelector("img").setAttribute("class",containerClass)},position:function(){var regex=new RegExp("(?:^|\\s)karma-position-(.*?)(?!\\S)"),imagePosition=this.getAttributes(["position"]);this.el.firstElementChild.className=this.el.firstElementChild.className.replace(regex," karma-position-"+imagePosition.position)},alt:function(){var imageAlt=this.getAttributes(["alt"]);this.el.querySelector("img").setAttribute("alt",imageAlt.alt)},linkurl:function(){var imageLink=this.getAttributes(["linkurl"]);this.el.querySelector(".karma-image-link").setAttribute("href",imageLink.linkurl)},linktarget:function(){var imageTarget=this.getAttributes(["linktarget"]);this.el.querySelector(".karma-image-link").setAttribute("target",imageTarget.linktarget)},action:function(){var action=this.getAttributes(["action"]),elClass="",elLink="";switch(action.action){case"none":elClass="karma-image-without-action";elLink="javascript:void(0);";$(this.el.querySelector(".karma-image-link")).off("click.karma-lightbox");break;case"popup":elClass="karma-image-popup-mode";var img=this.getAttributes(["imgurl"]);elLink=img.imgurl;new karmaImageLightbox(".karma-image-"+this.el.dataset.elementKey+" a.karma-image-link");break;case"link":elClass="karma-image-with-url";var link=this.getAttributes(["linkurl"]);elLink=link.linkurl;$(this.el.querySelector(".karma-image-link")).off("click.karma-lightbox");break;default:return false}this.el.querySelector(".karma-image-container").setAttribute("class","karma-image-container "+elClass);this.el.querySelector(".karma-image-link").setAttribute("href",elLink)}})})(jQuery,karmaBuilder);